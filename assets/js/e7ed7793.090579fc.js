"use strict";(self.webpackChunkreftree=self.webpackChunkreftree||[]).push([[66],{2468:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>c,toc:()=>u});var r=a(4848),t=a(8453),i=a(1470),s=a(9365);const l={sidebar_position:3},o="User guide",c={id:"Guide",title:"User guide",description:"Trees",source:"@site/../site-gen/target/mdoc/Guide.md",sourceDirName:".",slug:"/Guide",permalink:"/reftree/docs/Guide",draft:!1,unlisted:!1,editUrl:"https://github.com/stanch/reftree/tree/main/docs/../site-gen/target/mdoc/Guide.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"mainSidebar",previous:{title:"Getting started",permalink:"/reftree/docs/GettingStarted"},next:{title:"Talks / Demos",permalink:"/reftree/docs/talks/"}},d={},u=[{value:"Trees",id:"trees",level:2},{value:"Renderers",id:"renderers",level:2},{value:"Diagrams",id:"diagrams",level:2},{value:"Animations",id:"animations",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"user-guide",children:"User guide"}),"\n",(0,r.jsx)(n.h2,{id:"trees",children:"Trees"}),"\n",(0,r.jsxs)(n.p,{children:["This library renders diagrams based on a simple data representation called\n",(0,r.jsx)(n.a,{href:"https://github.com/stanch/reftree/blob/master/core/src/main/scala/reftree/core/RefTree.scala",children:(0,r.jsx)(n.code,{children:"RefTree"})}),".\nEssentially, a ",(0,r.jsx)(n.code,{children:"RefTree"})," denotes either an object (",(0,r.jsx)(n.code,{children:"AnyRef"}),") with a number of fields,\nor a primitive (",(0,r.jsx)(n.code,{children:"AnyVal"}),")."]}),"\n",(0,r.jsxs)(n.p,{children:["To render a value of type ",(0,r.jsx)(n.code,{children:"A"}),", you will need an implicit instance of ",(0,r.jsx)(n.code,{children:"ToRefTree[A]"}),".\nFor many Scala collections, as well as case classes, no extra work is needed,\nas these instances are readily available or generated on the fly."]}),"\n",(0,r.jsx)(n.p,{children:"You can configure the automatically generated instances like so:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'import reftree.core.ToRefTree\n\ncase class Tree(size: Int, value: Int, children: List[Tree])\n\nimplicit val treeDerivationConfig: ToRefTree.DerivationConfig[Tree] =\n  ToRefTree.DerivationConfig[Tree]\n    .rename("MyTree")                                // display as \u201cMyTree\u201d\n    .tweakField("size", _.withName("s"))             // label the field \u201cs\u201d, instead of \u201csize\u201d\n    .tweakField("value", _.withTreeHighlight(true))  // highlight the value\n    .tweakField("children", _.withoutName)           // do not label the \u201cchildren\u201d field\n\nimplicitly[ToRefTree[Tree]] // auto-derivation will use the configuration above\n'})}),"\n",(0,r.jsx)(n.p,{children:"For something custom, manual derivation is the way to go, for example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'import reftree.core._\n\nimplicit def treeInstance: ToRefTree[Tree] = ToRefTree[Tree] { tree =>\n  RefTree.Ref(tree, Seq(\n    // display the size as a hexadecimal number (why not?)\n    RefTree.Val.formatted(tree.size)(_.toHexString).toField.withName("s"),\n    // highlight the value\n    tree.value.refTree.withHighlight(true).toField.withName("value"),\n    // do not label the children\n    tree.children.refTree.toField\n  )).rename("MyTree") // change the name displayed for the class\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"renderers",children:"Renderers"}),"\n",(0,r.jsxs)(n.p,{children:["To render diagrams and animations, you will need a ",(0,r.jsx)(n.code,{children:"Renderer"}),"."]}),"\n","\n",(0,r.jsxs)(i.A,{groupId:"platform",children:[(0,r.jsxs)(s.A,{value:"jvm",label:"JVM",default:!0,children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:"import reftree.render._\nimport reftree.diagram._\nimport java.nio.file.Paths\n"})}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'val ImagePath = "images"\n'})}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'val renderer = Renderer(\n  renderingOptions = RenderingOptions(density = 75),\n  directory = Paths.get(ImagePath, "guide")\n)\n'})}),(0,r.jsxs)(n.p,{children:["You can also pass a ",(0,r.jsx)(n.code,{children:"format"})," parameter as a String to the ",(0,r.jsx)(n.code,{children:"Renderer"})," constructor\nto specify the format you require. The default is ",(0,r.jsx)(n.code,{children:"png"}),". You can specify any\nfile type supported by ",(0,r.jsx)(n.code,{children:"dot -T"}),"."]})]}),(0,r.jsx)(s.A,{value:"js",label:"Scala.js",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:"import reftree.render._\nimport reftree.diagram._\n\nval renderer = Renderer(\n  renderingOptions = RenderingOptions(density = 75)\n)\n"})})})]}),"\n",(0,r.jsx)(n.p,{children:"There are two ways to use renderers:"}),"\n",(0,r.jsxs)(i.A,{groupId:"platform",children:[(0,r.jsx)(s.A,{value:"jvm",label:"JVM",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'import scala.collection.immutable.Queue\n\n// Option 1: using the `render` method\nrenderer.render("queue", Diagram(Queue(1)))\n\n// Option 2: using syntactic sugar\nimport renderer._\nDiagram(Queue(1)).render("queue")\n'})})}),(0,r.jsx)(s.A,{value:"js",label:"Scala.js",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'import org.scalajs.dom\n\n// Option 1: using the `render` method\nrenderer.render(dom.document.getElementById("diagram"), Diagram(List(1)))\n\n// Option 2: using syntactic sugar\nimport renderer._\nDiagram(List(1)).render(dom.document.getElementById("diagram"))\n'})})})]}),"\n",(0,r.jsx)(n.p,{children:"You can set various options, for example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'// using the `render` method\nrenderer.tweakRendering(_.withVerticalSpacing(2)).render("queue", Diagram(Queue(1)))\n\n// using syntactic sugar\nDiagram(Queue(1)).render("queue", _.withVerticalSpacing(2))\n'})}),"\n",(0,r.jsx)(n.h2,{id:"diagrams",children:"Diagrams"}),"\n",(0,r.jsx)(n.p,{children:"Diagrams can be created and combined into bigger diagrams using the following API:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'// no caption\nDiagram(Queue(1)).render("caption-none")\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"caption-none",src:a(4990).A+"",width:"187",height:"274"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'// automatically set caption to "Queue(1) :+ 2"\nDiagram.sourceCodeCaption(Queue(1) :+ 2).render("caption-source")\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"caption-source",src:a(1127).A+"",width:"297",height:"372"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'// use toString to get the caption, i.e. "Queue(1, 2)"\nDiagram.toStringCaption(Queue(1) :+ 2).render("caption-tostring")\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"caption-tostring",src:a(1664).A+"",width:"288",height:"372"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'// merge two diagrams, set captions manually\n(Diagram(Queue(1)).withCaption("one") + Diagram(Queue(2)).withCaption("two")).render("one-two")\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"one-two",src:a(6462).A+"",width:"392",height:"372"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'// isolate each diagram in its own namespace (graph nodes will not be shared across them)\n(Diagram(Queue(1)).toNamespace("one") + Diagram(Queue(2)).toNamespace("two")).render("namespaced")\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"namespaced",src:a(6132).A+"",width:"402",height:"274"})}),"\n",(0,r.jsx)(n.h2,{id:"animations",children:"Animations"}),"\n",(0,r.jsx)(n.p,{children:"Animation is essentially a sequence of diagrams, which can be rendered to an animated GIF.\nThe simplest way to create an animation is to use the builder API:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'(Animation\n  .startWith(Queue(1))\n  .iterateWithIndex(2)((queue, i) => queue :+ (i + 1))\n  .build()\n  .render("animation-simple"))\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"animation-simple",src:a(949).A+"",width:"330",height:"471"})}),"\n",(0,r.jsx)(n.p,{children:"You can also configure how the diagram for each frame is produced:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'(Animation\n  .startWith(Queue(1))\n  .iterateWithIndex(2)((queue, i) => queue :+ (i + 1))\n  .build(Diagram(_).withCaption("My Queue").withColor(2))\n  .render("animation-captioned-red"))\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"animation-captioned-red",src:a(5802).A+"",width:"305",height:"471"})}),"\n",(0,r.jsxs)(n.p,{children:["Note that by default the library will try to reduce the average movement of\nall tree nodes across animation frames. Sometimes you want to \u201canchor\u201d\nthe root of the data structure instead, to force it to stay still\nwhile everything else is moving. You can achieve this via ",(0,r.jsx)(n.code,{children:"withAnchor"})," method:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'(Animation\n  .startWith(Queue(1))\n  .iterateWithIndex(2)((queue, i) => queue :+ (i + 1))\n  .build(Diagram(_).withAnchor("queue").withCaption("This node is anchored!"))\n  .render("animation-anchored"))\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"animation-anchored",src:a(2955).A+"",width:"365",height:"471"})}),"\n",(0,r.jsx)(n.p,{children:"Finally, animations can be combined in sequence or in parallel, for example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:'val queue1 = (Animation\n  .startWith(Queue(1))\n  .iterateWithIndex(2)((queue, i) => queue :+ (i + 1))\n  .build()\n  .toNamespace("one"))\n\nval queue2 = (Animation\n  .startWith(Queue(10))\n  .iterateWithIndex(2)((queue, i) => queue :+ (10 * (i + 1)))\n  .build()\n  .toNamespace("two"))\n\n(queue1 + queue2).render("animation-parallel")\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"animation-parallel",src:a(7938).A+"",width:"610",height:"471"})})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},9365:(e,n,a)=>{a.d(n,{A:()=>s});a(6540);var r=a(4164);const t={tabItem:"tabItem_Ymn6"};var i=a(4848);function s(e){let{children:n,hidden:a,className:s}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,s),hidden:a,children:n})}},1470:(e,n,a)=>{a.d(n,{A:()=>y});var r=a(6540),t=a(4164),i=a(3104),s=a(6347),l=a(205),o=a(7485),c=a(1682),d=a(679);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:a}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:a,attributes:r,default:t}}=e;return{value:n,label:a,attributes:r,default:t}}))}(a);return function(e){const n=(0,c.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,a])}function m(e){let{value:n,tabValues:a}=e;return a.some((e=>e.value===n))}function p(e){let{queryString:n=!1,groupId:a}=e;const t=(0,s.W6)(),i=function(e){let{queryString:n=!1,groupId:a}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:n,groupId:a});return[(0,o.aZ)(i),(0,r.useCallback)((e=>{if(!i)return;const n=new URLSearchParams(t.location.search);n.set(i,e),t.replace({...t.location,search:n.toString()})}),[i,t])]}function g(e){const{defaultValue:n,queryString:a=!1,groupId:t}=e,i=h(e),[s,o]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=a.find((e=>e.default))??a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:i}))),[c,u]=p({queryString:a,groupId:t}),[g,f]=function(e){let{groupId:n}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(n),[t,i]=(0,d.Dv)(a);return[t,(0,r.useCallback)((e=>{a&&i.set(e)}),[a,i])]}({groupId:t}),x=(()=>{const e=c??g;return m({value:e,tabValues:i})?e:null})();(0,l.A)((()=>{x&&o(x)}),[x]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),f(e)}),[u,f,i]),tabValues:i}}var f=a(2303);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=a(4848);function j(e){let{className:n,block:a,selectedValue:r,selectValue:s,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),d=e=>{const n=e.currentTarget,a=o.indexOf(n),t=l[a].value;t!==r&&(c(n),s(t))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const a=o.indexOf(e.currentTarget)+1;n=o[a]??o[0];break}case"ArrowLeft":{const a=o.indexOf(e.currentTarget)-1;n=o[a]??o[o.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":a},n),children:l.map((e=>{let{value:n,label:a,attributes:i}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>o.push(e),onKeyDown:u,onClick:d,...i,className:(0,t.A)("tabs__item",x.tabItem,i?.className,{"tabs__item--active":r===n}),children:a??n},n)}))})}function v(e){let{lazy:n,children:a,selectedValue:t}=e;const i=(Array.isArray(a)?a:[a]).filter(Boolean);if(n){const e=i.find((e=>e.props.value===t));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function w(e){const n=g(e);return(0,b.jsxs)("div",{className:(0,t.A)("tabs-container",x.tabList),children:[(0,b.jsx)(j,{...n,...e}),(0,b.jsx)(v,{...n,...e})]})}function y(e){const n=(0,f.A)();return(0,b.jsx)(w,{...e,children:u(e.children)},String(n))}},2955:(e,n,a)=>{a.d(n,{A:()=>r});const r=a.p+"assets/images/animation-anchored-8c8b5dfa237ead06adb46717a46ae600.gif"},5802:(e,n,a)=>{a.d(n,{A:()=>r});const r=a.p+"assets/images/animation-captioned-red-83dcdff0e9a287254cfdb063d0bb5ffe.gif"},7938:(e,n,a)=>{a.d(n,{A:()=>r});const r=a.p+"assets/images/animation-parallel-290fc9d667a8b0509bdbfa044269f886.gif"},949:(e,n,a)=>{a.d(n,{A:()=>r});const r=a.p+"assets/images/animation-simple-2f9602a0503b36aed74a8e40e2b0b745.gif"},4990:(e,n,a)=>{a.d(n,{A:()=>r});const r=a.p+"assets/images/caption-none-5d20b75c0a1aa4c1ffc800e1d6b6660f.png"},1127:(e,n,a)=>{a.d(n,{A:()=>r});const r=a.p+"assets/images/caption-source-31a271258492ebebc6722d8e8933ea46.png"},1664:(e,n,a)=>{a.d(n,{A:()=>r});const r=a.p+"assets/images/caption-tostring-ba525adeb95638e83be22d8857c98a9c.png"},6132:(e,n,a)=>{a.d(n,{A:()=>r});const r=a.p+"assets/images/namespaced-6dd14cbd377faee7a4c6a3be9940fe68.png"},6462:(e,n,a)=>{a.d(n,{A:()=>r});const r=a.p+"assets/images/one-two-fe52e6208faa3021867df57332b3e6ec.png"},8453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>l});var r=a(6540);const t={},i=r.createContext(t);function s(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);