<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-talks/Visualize" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Visualize your data structures! | RefTree</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://stanch.github.io/reftree/docs/talks/Visualize"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Visualize your data structures! | RefTree"><meta data-rh="true" name="description" content="A journey deep inside reftree’s animations feature, showing how some of functional programming techniques and concepts can be applied to produce visualizations of themselves."><meta data-rh="true" property="og:description" content="A journey deep inside reftree’s animations feature, showing how some of functional programming techniques and concepts can be applied to produce visualizations of themselves."><link data-rh="true" rel="canonical" href="https://stanch.github.io/reftree/docs/talks/Visualize"><link data-rh="true" rel="alternate" href="https://stanch.github.io/reftree/docs/talks/Visualize" hreflang="en"><link data-rh="true" rel="alternate" href="https://stanch.github.io/reftree/docs/talks/Visualize" hreflang="x-default"><link rel="stylesheet" href="/reftree/assets/css/styles.70297ef0.css">
<script src="/reftree/assets/js/runtime~main.56fa2c0d.js" defer="defer"></script>
<script src="/reftree/assets/js/main.4cb1021e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/reftree/"><b class="navbar__title text--truncate">RefTree</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/stanch/reftree" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/reftree/docs/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/reftree/docs/GettingStarted">Getting started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/reftree/docs/Guide">User guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/reftree/docs/talks/">Talks / Demos</a><button aria-label="Collapse sidebar category &#x27;Talks / Demos&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reftree/docs/talks/Immutability">Unzipping Immutability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reftree/docs/talks/Visualize">Visualize your data structures!</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/reftree/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/reftree/docs/talks/"><span itemprop="name">Talks / Demos</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Visualize your data structures!</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Visualize your data structures!</h1>
<p>This page contains the materials for my talk “Visualize your data structures!”.</p>
<!-- -->
<div style="margin-bottom:1em;width:640px;height:360px"></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Older videos</summary><div><div class="collapsibleContent_i85q"><ul>
<li>ScalaDays Chicago, April 2017: <a href="https://www.youtube.com/watch?v=6mWaqGHeg3g" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=6mWaqGHeg3g</a></li>
</ul></div></div></details>
<p>You can use this page in two ways:</p>
<ul>
<li>as a reference/refresher on the material covered in the talk;</li>
<li>as an interactive playground where you can try the same commands I presented.</li>
</ul>
<p>Throughout this page we will assume the following
declarations (each section might add its own):</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">core</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">diagram</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">render</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">geometry</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">svg</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">animation</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">Frame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">svg</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">XmlSvgApi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">svg</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">XmlSvgApi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svgUnzip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">contrib</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">XmlInstances</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">contrib</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">OpticInstances</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">contrib</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">ZipperInstances</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">contrib</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">ShapelessInstances</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">util</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">Optics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">demo</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">Data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">demo</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">Shortcuts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">scala</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">collection</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">immutable</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">java</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">nio</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">file</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">Paths</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Diagram</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">sourceCodeCaption </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"> diagram</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To start an interactive session, just run</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sbt demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@ render(List(1, 2, 3))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>and open <code>diagram.png</code> in your favorite image viewer (hopefully one that
reloads images automatically on file change). You will also need to have
<a href="http://www.graphviz.org/" target="_blank" rel="noopener noreferrer">GraphViz</a> installed. <em>The interactive session
already has all the necessary imports in scope.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introducing-reftree">Introducing <code>reftree</code><a class="hash-link" aria-label="Direct link to introducing-reftree" title="Direct link to introducing-reftree" href="/reftree/docs/talks/Visualize#introducing-reftree">​</a></h2>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// extra declarations for this section</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> renderer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Renderer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  renderingOptions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> RenderingOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">density </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  directory </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Paths</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ImagePath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;visualize&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">renderer</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">_</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://stanch.github.io/reftree" target="_blank" rel="noopener noreferrer">reftree</a> is a library for visualizing Scala data structures.</p>
<p>Let’s look at a quick usage example:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> Person</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">firstName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> age</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> bob </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Person</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Bob&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// bob: Person = Person(firstName = &quot;Bob&quot;, age = 42)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;bob&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="bob" src="/reftree/assets/images/bob-6e8dad95c440d488af22193a37ae0d7f.png" width="313" height="363" class="img_ev3q"></p>
<p>That’s it! You can configure the visualization as you like:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// render strings as a single box</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">contrib</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">SimplifiedInstances</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">string</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// rename the firstName field (pun not intended)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">implicit</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> personConfig</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ToRefTree</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DerivationConfig</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Person</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ToRefTree</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DerivationConfig</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Person</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tweakField</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;firstName&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">withName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;bob-simplified&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="bob-simplified" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAO4AAAFsCAYAAADL4YVFAAAABmJLR0QA/wD/AP+gvaeTAAAgAElEQVR4nO3de3wcdb3/8ddndpOUXpJNaQERBUXxggVKEUEEerweCtm0HOMFPUc9hxaVI1qahIuiqwhINi0XQaSgB0QuNkjbBOhBRKvgTzlIQUFRBEWs0NJLdpO2NE12Pr8/mpRtmtI22WR3mvfz8fABzHznO5+p++53dnbmOyAiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiJSwvY76cxb9z9p9lNR61tkqIJiFzAkFkxz/OHI9S0yRJEN7uTpnx+P+5uxoODhGs6+RQohssHFt0wFgjCk8OEazr5FCiBe7AIGK3A72qEzV8Gzk0+cc4kFfqo5rw+NX8Us9oVVy7/7XP9tJp045zWB+VeBE4CDgT+62YI1v1jYMtS+RUZSZEdcd6YB68q3+G/Mwtc6dgluF5tzchjm7qGuLpbffr8TZ38osPAJ4Fh3W4jxacyeMfdF+508+/ND6VtkpEV2xMWYBlS789GXHrzxvr7Fk0+c023m3z5gTdWJq2A5wH7vO3N/urkNs59Vjh3zyWeWfburt/ni/U6ePcacbx5+eN2Nf/hDy5Y97VukGCI54h44bc5Y4C3mnnrpwRvuy18XxHLLATzk0L5l3sM3Acri5Z/NC+3WdaH/yKF6XSLx5sH0LVIMkQxuzzg/Cog5/kj/dSFBHMA9WNe3zNymY7T+84Fr1/VvbwFZAIJw3GD6FimGSAbX3Y4GQttny+P91wWhvR0gDHuegt6fduBQQv/jQH1ZGLwDyAWbYk/uad8ixRLJ4Frg0zCeWv2TWzb2Xxe6z8Z5du2Bnc8ArOns6QJyBEzYsadU4Ob/ATzywqMLN+1p3yLFEsng4hyNEx50/Nx98hfvd+Lsz5ox3fHzaWnJAfDowm7g97j9W/+rwZNP+ufXgSmBcc6g+hYpEit2AXvqkOmfHrMpLOsENuM8HgT21TD0iQQ2E/dP4ix46cEb5uVvs//02e/3kPtwfob5dZiNM+djDu/DbO5Lv1h43WD7FimGyI24m3OxI4BYLrB3Yrwcuj9gxg3mXu1mHxkoWKuX3/BTN5/uEDfsRtxS7mRxP7YvtIPtW0QGoeo9n6vuvQAVqb5FRERERERERERERERERERERERERERERERERERERERERERERERERF7NqHzr3H4nz/782DccU7HpuUefL3YtIoMRuelZC8K5wELeX+wyRAZrdAZXJOIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIsmIXMBL2O3H2v7lxNr71LyqDN2De4W7rAMx8iwflp69Z/p0Nxa1UZPfEi13ASPBY+DsLg3/Z/q8pwwzA3bGHFFqJklFxqrxm+feecfwxnHCg9YFxy0jXJDIUoyK4AIEHt7j1+2bgABbG4+V3FaMmkcEaNcHNwR3mvv1Co8eNZf984Np1xalKZHBGTXDXPrjwRTceBHJ5i+NByK3FqklksEZNcAECtx+y/TFvDmNldxerHpHBGlXB7YptudOhB8CxHtwX62qyRNGoCm5m+U0ZsP/FCQ2PW+C3F7smkcEYVcEFCAhvxQgcOiat7biv2PWIDMaI3zk1seZbh7vFkiGcZPAOYH+gbMQKcKe84xlyZZXkxu4/YruVvUoWeMZgReh+3zg2LXuhLbVpJAsYseBW1zbNcLcvA+8GOnGWe+BPBM5KzLKhe/dI1VLe8fwXcuXjH8iNmfjHkdrnYJnbFVj4uGM3F7uWYjDsZvAWh5K4iGgwASxh8FbH3g1+OJAB/15YEb+0o+Xc9SNUx/CakLz8LYEHC8yYgbMc7KrMmA330pLaMtz73plJ7zlz2tqHDnoMUgPeSVVKqmrSfzT8fzNtjecWu5ZiSCTTHUAq09qwoNi1DKTq1CveSKznTIPPAz2GX9RecchCWj6S2+XGQzCs9ypX1zad7W4LMP6BMzPT1rB0OPe3u9Y+dOOjxa5B9g7Ze+b+Fbhw/Kz0lfEev8TNrqnu+vunYqdfMWvtXXNfHK79Ds/FqbpFsURt89Xudg3u12a6Kw4vldCKDIcNixteyrQ1zg6D8HiHA3t6eh5OnDb/yOHaX+GDW7coltjy3J24f9axszJtjeey7Jyugu9HpAR1LDnv/+Lx+LuAVQThQ9W1TScOx34KHtzEluevwO1Uc6vNttYvLHT/IqVu7V1zXxzrG6cD/+dud1XNbDq00PsoaHCrapvPxP0Lhn+xva1+WSH7FomSF9pSm4Luillgqwnt7qpTL6suZP8FC+6E5OVvMfdrcb+ivbXxukL1KxJV65ed0xESzDRnP4uVNRey74IFNyC4AnxlpmfMBYXqUyTqOlrPfcYDLgT/dOXMy48tVL8FCW51bdMMg1Nw04UokX6y5QffCPzOPLgSvCD3ThQkuCH2FZzl+slHZAAtH8lBOM+c46tOW/DeQnQ55OBWn5p+hznHg11ViIJE9kaZ1vN+jvEkQXhmIfob+ogbeBLYkOkp11VkkVfj9iODGdSlyofa1ZCDG5qdCLZc321FXl3o3AdUVm4eP+Q7qoZ8r7LBO9x9VD65UmqqatLfDALe2b604UNVNU0fNLPzgGOADWBNmdb6Hb7OVNYtmBhs7rkcowYs7vCIG6nAme342Gxr4xkTa+YfF1r4y8CCQ0PPXQN2PM6lZTm/oztu3wVOwP07mbbGr23XeV2qPNE1vhH8X4Ej3FlpZrdlDphwOQvPGpanwXbneLb7Mzv1smqLxb4GvBfsQIdH3O2rZuF/AlXbtR/i8VSOCZ7c0JXLBRZOAR4ZynEW4uLU/oH5PwvQjwyRGUe582IimU5hdhVmdzvW4NABfkVVTfoN+e0nzJp/WNCVexizfwW7FmO2OU+bsxz4CPA4gJsfBWzJeW4RFizH7W8YjT1xW4LZL4C/YzY3/4ppYkbzwYmusb/F/EzDbzX8lCDwa8HrE6s75w/H8e/u8fSpTC54k8XivwGrg2AR2JzA+Xtg/qBhZ+S3L8TxrGw592VgvWFDfhB8aCNuXaqcLsrc2DjUQqQgpgIJx3+Qrdh0ZN+jk9U1zZ1ufhsevBH429ambrFc8x3AljjhyWtbz3uht4/Fidr0szhX4b0fXPejMAzn7Exr/Yqq2qZJ5lZvHpze3jrvN4lk+iDgMDDv65t48/fBQu/pmZq554L23r5/lahpCoArDqpbcF7vB7lA9uB4ehk9t4AFgQXHrV867x+9i+9KJJtXgl/8SvtCHo93hsb4oR7t0IK7YaJR1gVh4LtuLMNp/CmXTgYONHxhprXxc/nrwoBucwhi9lLfsupk8yccpoLlf8gBMGe9A7m4bf3gGkfhPJBta1wBEHjwZscfWt827zdbt/A3Ofyhb/tEcv4s4L1hEL6ro3Xbh7y3q+Axx2ObNm95I3nbDNUeHQ9QVdv8YXM/zsxPzQvt1vbmf3V/pX1hj8ccH/pz8KPi3UGjQSwenwpgFtvheoM5bwVy+4Qdz/Z96hw+DDyWaa3/Zf/2jh8D9sKGxQ0vkUoFvoIp4M356834cd4ejsZozevhBIAgDB5OJNP9+wagy8asHeShDmi3j6evYvda8L+2L228d4f2oR+D5bcf+ePZFQV3b2EcBYRlL4e/23GlTwX7U795kQ4H/t9OOnsn8BjAvo+OPyxnPpZg6+jTe7P8G3AehW0j/UGErMjb3xSwXwae+/yA3Qdx37j0S6v38Ah3ZbeOJ8/bMX4/cHM7xrc7rS7K8bwqBXfvcZTD06t/0jDA9QY7GvMH+y08EKxzh6bTU3FgqjsLAMKtF6bAerZ+8OPxaTj0xIIVkD/SB9uCawQZxw9b33Z+wU6Fd8NuHU+eAzy0P+3QPpUKWMFUAr+6b1GRjudVjbrpWfdeNhW8/6jSO0L6IduPiAA8B358/oLJddeOT0wYdxewT98I2zuSZzJLLngOIMCPATZ0Htn5DEAQcDSwJVPRmfeh9seAKYmZTUf1ryeRbD5p0If46p7breN5xd/MOJa6RbFtS+pS5YkV4/4HGA9B3p9lUY7nVWnE3QscWJMauwkOc+z7O6wMto6ImPUP7veA+Yma9Pct8DvD0KZ0b9n0SYy/bG0fbv3gOkflX411t2nAY6R6J9pzmwo8mT/5X4zwmh6Csz20ZVW1zRfFQnsyJPdWsNPB31tVk56SbWv4WwH/CHb/eLaxG8Bvqu56/naS6ZsdexNd/in63nThwbZjLtLxvCqNuHuBDcG4KUCA7fA9DjObCnjQXb7diJOpOPgq4KsY093tBxb4ceb+WTe7DejMLmn4K4DjR2Hb/YwyDXzbXwIOR9Pv++Pa1vM644THGvzU3C8KLbwPs9kYf4nH428ejg/57h7Ptvat834A9iXHj3K4FcJTMS7GuQ3o7Gid+2wxj2d4nXJ1RSKZ9kRN878Xu5S9VVVN+o+JmqaSnJp0JCSS6Y5EMj1iU9MmkukliWT6gWHs/5mqZPrSofajEVdGIbftvtv2qprZPA04zYzvFaGoPaLvuDLqVCebz/YuvkgyfV1o9geAwMP3EPo5wOL27MZFRS5xlxRcGXXiFWNv6u7aVO14XeBcBLjDnzGbl81uuInlqZ5i17grCq6MOmtazt4AXNz7v0jSd1yRCFJwRSJo5E+VT7m6IlHWtXm7Zc56jJUGd1CR+057y/nZEa9LJEKKNuIa3IczE+N0D+w84HGHb/jm2JLe+0tFZCeKFpAQ/1u2rTF/Otcbq2qanjCzdPWE8R9oB00+J7ITJTWyhfFYaywXpgnCI+kX3OraBVOc3Ndw3glMAP7g+NXZ1saW/HYTa751eGixJ81iR7TvP+5PVauyc3H7tBmvB/5sbl9sb6t/COCQ6akx2Qnjz/XAP45zCJBxeMLM78iUH3LrQC8nTiTnJ/FwLsaRQMadXwfkLmhvO//5vjZVM5unWei/jbm9DSBnpMFPAjoNvydeMW5e75VNkUEpqYtT8S1hOYBj+c+NUl2bPsM9twJnMu5fAzvT8ScNuz2RTF80UF8huf0Tqzp+ZlgjAT/HfT7mz4dhbNvsCJnKcTeE5hcZ3GFuHwH7imF/xe266q7n5vTvs6q26RIIl7qx2bALDW6wgBPcYk8O9HqJHvyTPeY/d3wD8HXwRx2b07154xVD/sOSUa2kRlzifBKHgOC3fYsSM5oPdvfvGtzV3trw0bzWdyWS6VXAVyaefvn/rL/rvJX5XZlzHc5KG5M7NDPQxa6tz13WGdzRvrThkrw1N0+oaU51Ttu4Pn9Oh4k1848LPTwf9xuzbY2z+5ZPmHXpwliu7LHAg+8x5/qj82f7M+Os0DitY2nDw72LFiSS6V9g9u+kUmdte8JGZA8VLbgB9oZETbqWgMDc9nf8g+7MBG5ev3TeKzMZlHktzoRc6F/ZoQ8Lvh96mApzwTuB7YKLURYnTK5tOX/Hh6sBUqmQZNPTYDMSNc0zM6+ZcE9f6Drb6tfStn3z0MJPANYTty/nL+9cfOG6RG26Geeqyhc7j+rIm3bTsIs6ltY/vF1H7ssxO2nf31a+Zh3senZMM8NJVCYXvGmXbfdKoTk+ae85/lyZwz5D7aVowXX4EMaHcHB8jePPGpyZ6dj0g+1b2lRwgsCe7j/fT+hbByxzXrvjHuyqta3nDRzavu1D/i0IuAnzxYlVHZusNv2QhywLguDH/ScQA6YAK/PnLdq2p9BWuDmGH0FecEP3AebatXaALUH3bs7052UYnwnIfWb32u9ljE5zLjBye81bIM1511D7KGJw/bvZfrMRDtzQM0DO3WcYDPi2hHiOP/dfZoRbBmqbr+Puxr8AJ1Qn00eE8CFz3ufGZaGH30ok0xdmWhvyH6cLMAY8tTX3nBtgtsMTJzs2NofdnxQzwLqBFg/8O7u90d4k5B43vmNGy64blz4LudW3f755UErrO+6A/AmwmMVsS2ZJwy+GYw/trQ2/B34PpCfUNE+KBeEduDVPntF025p7G1cBuPGEOSdMmHXpvp2LL1y3XYW29azAzQeYqG1oQnc3fGVmSePyQvcdBYlkOmfOs5mlDcuLXUshJJLpl4HMUPspqavKA/FcbrHDKkKuPLAmNbb/+t5ZB/fY5Lprxydqmmf2f19pZ1v9WguDnwHWXZ4b07c8CO12wIKw7Bv57RMzr0i40eDwp47yjTvMQCEyHEp+xM3ec0F7dW3Tf7nbnZts3J+qatLXmtlf8PC1FthpofN68Le/Mov+7tnStfEUM7s1kWx+AtKtbv4nPFiP+9Fufr4792Z7J0gDaG+rf6g62ZzGvTGRbDrI3VrBqwm7Pwc2OebB+/PnXRIZTiU/4gK0L228153DgV8ExmfAbyGwOe62Mh4LT9/T0AJkWxtb6LE3g/8cZ7q5fdvwFjM+5nDxhDGxD+9QR2v9ebjNAqsyo9ksONvhYYKed7wyq7/I8Bv5EXfZOV0Z9vwVDL0Tcu1ybqveuW93q//MvfV/B+oH3N/OtmmrXwIsebV+s0vqH91ZDb1vzNNLwGVIIjHiisj2FFyRCFJwRSJIwRWJoJL/OUik0BI1TV/A7GqHO7KtDR/PXzcueeX+5Wz5hmMzgH0xnsVZlOjYmH5ueWrzTroccQqujCpVycuPcazJoL3/uupk0wlOd4tjneA3YfzFQnu3G1/LVI49BqgtQskDUnBl1EjMvCJB2LMIuBEGuNE/Z1mLeds+vmlu3ruEf5BINv8FaK6sTb8r7xHNolJwZfTw7v8BCys2c/7mCh7p/0t7+z0NTwJn9R+KPQiXWGjNhk0BSiK4ujglr6pqZtOhk5KXTyh2HUOVqG2ei9spENSt/knDRjPKdndbC/31AA79H/UsGgVXdiqRbPpPC+0vPQT/HD8rvV+x6xmsiTXzj8P9cje+mGmdt+cPglhsFrApvqX814WvbnAUXNkpd3sfW2/dnFAWDv3h72KorFswMbTwR47fmV3acP2ebt8b+s87pNYvO6djOGocDAVXdirArgOeAb+/Krvx/mLXs+fcgq7wZoOXyyvG7TD5366MS165f2i5W3F7NNtRWhP86eKU7FTvNLZvhgI8+V0E1cn0ux07zYHurk2d/ac+MnhTIpn+2ECzsVTWLZgYdG25H8x74l5Tam/wU3Blr5WriD8V68qdNtA6hxuAZwwuN4s/n7+u6tTLqq0rdx/YpJDYSRsWn7vDPGPFpuDKXquj5dz1wD0DrUsk0xsd/plpbdhu/eQZTQd0x/gJUB2GfnLH3ec+MxK17ikFV6RXYuZlh3SH9lPgIDOfZzGOTiSb353fJk7url3NHvrq3AbxOPoOhhbcZed0kUx3mzFuyJWIFJmHsfMMDgVwt2u2xmv7yVW6A3sIGEJwbXwwpO23GvKI67AO/ICh9iMykjKtDW/uv6z3AtWupwwerLpUOV1MDM3WDLWrIf8cZPAkcMRQ+xHZ2yW6x74diMewPw61r0L8jvsrnJOpW7TrycBFRjHP8X5g4/ps54qh9jXk4HpgbRgTqzY/976h9iWyNzOCOszvpwDP9Q45uL0zGj5u2H8PtS+RvVVlTfM7MT/WsO8Xor+C3PJocDlGTWJmenoh+hPZu7gF5vPBn2gvP/jeQvRYkOC2tzbcAfyS0K5hekq/DYvkqa6Z/zHgRCeYR8tHcoXos2APGbj7XPC3VU8Y21ioPkWibtLpV7zGzZuBO7Ot9QV7UKNgwc22Na4ALnazixO16VmF6lckqg6qW7BPT3duCRDG4/FzCtl3QR/ry7TWf91hEc4tlTMvP7aQfYtESt2i2Mau8GbMD4cgufauuS8WsvsCP49rnu3Y+Bng8SAMHkgk5ycL279I6Zt4ytWVVV1/b3N8Js4nBjXrxi4U/kH65anN4ytiHzBsGYSLq2qa6vu/g1Zkb1U1s+nQsLzrVwbHeRickmlrWDoc+xmWGTBWtpz7cnvrvI+6c5mZNVUnm3+tU2fZmx1YkxqbqGn6uoX2BE55LhYcl7173gPDtb9hnLrGPNvW8BXDT3QoC8Lg14lk0w8VYNmbVNd9q6o6mf7vTTbuKTdrBJrH+sapnYvnPT2c+x2ZU9hUKqhaMe6/DD8f7I3A3wy/PzRbEcALIbw8InVEUBD6mBxBzgLvLnYtxWDOUje/BezOYtcCgJsFziQ3f4sZx7tzMhA4fiduX+59j/OwG9nvnqlUUPXYuPeaUwucBLwNdn9+W5HS4avd7dHAWBbv8TvX3Nu4aiT3XtyLRnOuLxu/pqM6tiU+vqh1yM4FPb8yWORh/Kpil1IKzHO5wMvbS2mqVpEdJJLpfySS6VSx65DtaV5lkQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSJIwRWJIAVXJIIUXJEIUnBFIkjBFYkgBVckghRckQhScEUiSMEViSAFVySCFFyRCFJwRSLIil2AlJbq2gVTQu956ytL7Dqwn0HY0rekvGLcsjUtZ28oRn2yVbzYBUiJCXsONrNF2y/0OrA6AIdVaw5f81paBtpYRopOlWU77a+pug/I7mR1j8FtpFLhSNYkO1JwZXsLz+o25w6gZ4C1cQ/stpEuSXak4MoOHL+dgb5Guf89u6T+0ZGvSPpTcGUHmbaGXwIv9P23b/1HD2Y3Faci6U/BlQGYm3EbvafLvT89xIMdLlpJsSi4MqAwzDtddhznd+uX1v+xuFVJHwVXBpRta1wBPIubuxE6/sNi1ySvUHDl1dyCuZkTxMr8jmIXI6/QnVMRM/6USyfH4mX/YvjhYAkzHzNsO3Oq3OyjDqsCvHXY9gOAZR1bTeCPZsoOfpCWj+SGd3/RpuBGQSoVVD02tg63Txl8gK3fPV8A1gLdw7lrg7cBax3WDPN+xju8FhgPvhoLFgXwXX2vHpiCW+ImnpY+Pgy4CjgG+KVjt4XOXZ1t9WtHYv/VyfR/98S6b+9cfOG6Yd9ZKhUkVkw40gg/7vBx4ACc73jYk8rec0H7sO8/QhTckuVWVdN8sRkXAr8NPDhnfdu834x4GdNTcZanBrqLanjNub4ssarzHPCLgE2hMatjacPDI15HiVJwS9BBdQv22diVu8nhww7nZ4/eOH+03h88eUbTAd1xawGmufPpbFuDfktGwS09qVSQeGzsj3H7AARnZFrnDfNFoQg45eqKRHnXDTifwDk909awtNglFZuCW2Kqa9Npd+aa+8z2tsa7i11P6XCrqmn+oRmzQreTO9rqHyl2RcWk33FLSHUyfao79QZfUmj7M58wJnYmbk8E5rczPTV8P4NFgIJbKupS5Q4LgJ+2tzZcU+xyStHKlnNf9lh4BnBQddW4ecWup5gU3BKR2DL+bOANsVh4TrFrKWXZJY3PmnGlOxeMS165f7HrKRYFt1S4nwncvm7xeU8Vu5SSV567zCFWZj1nFLuUYlFwS0AiOX8q8HZ3v7XYtURBe8v5WYO7cf94sWspFgW3JISnAeuynZt+VuxKosKdFuCdk06/4jXFrqUYNMtjaTgC88f35A6l6tqmE93tve7+ZLat8cfglkg2fxXAKnJXtrecv7MJ3wqmambzNAv9t+6cmW1r+N4I1/wIQHd39xTgxcEdQXQpuKXAmQS2ck82CZ3jDVJm9kPgx2AO6a8BFrxcfiO9MzVOmHXpvrFcWf59zSGwGvgDzjUjeTPD7ta8O7I9FS8kyroIzPYbtoJLmE6VS4AHVABde7KNEWxt7688HeS9fXSV5QZ6YugesE+72VmYfRc4EGNJdW16xC7wDKLmnVt2ThdAaDYqf8/ViBtRbuEqc8ONVX3LDFsF/roN8YN3eJLH3Z7IttXf3Pff+38wPb9rDE97yGxgRKZc3dOaZecU3IgKnJUOBJ5/iu0rgdjuPIS++icNGxO1TU+BHTzQ+kRyfhIP52IcCWTc+XVA7oL2tvOf36EWs81Vtc0fNufz4NOAZ8FuzrTWX1XImuUVOlWOKg//AUDg/9i2CP8H8I+dbZKvsm7BRNyOxOyh/uuqapsugXCpG5sNu9DgBgs4wS32ZOXMy4/doRS4wNwXuIW/NvMLgXbwK6uS6UsLWbO8QiNuRLV3bn4hUTkudA+2jV7B1gtcsYHam/GO6mTzJ5ywAux1dPX8h8MzuYDz8ttNrJl/XOjh+bjfmG1rnN23fMKsSxfGcmWPBR58jznXH83Cs/K+k4YveC534raH3VOp6xKPjf2JuX1p/Kz0lRsWN7w0mJpl5xTcqFqe6sn0+8C3tzY07nwDP83htFceCLOMwa1s7vb8VqGFnwCsJ25fzl/eufjCdYnadDPOVZUvdh7V0ftzDIC7/Wi7GWwoCUwAAAQPSURBVCpSqdCTTdcbvC/ew/HA0sHVLDujU+VRwt2+lWltsExrfZCLdU8K8I8DyXhZ/Il+9/xOAVb2jZL5LLQVAIYfsesd8uzWjeyQApQv/WjEHXXMOxezDvjfytOang0Ce7rcus/cCJf0NggwBpxtw9xzboDZLk9tzYLx4ODhsN8IMhppxB3F9tliLwDuzqS+ZW48gfO6CbMu3bd/ezebuvWf/rvd6H4qQBiYHpoYBgruKLZ5DGcAZrDtDXxBaLcDFoRl38hvm5h5RcKNBoc/dZRvfCx/XRDw1v5tMZ/rzlMd2Y16u98w0KnyKLHtqrITgO+LcSJQCzzYXrFx2wRs7W31D1Unm9O4NyaSTQe5Wyt4NWH358Amxzx4Py2pLfl9u3NuIpk+CoJvQ/gmwp7PAgcAM4oyQ+QooBF31PDTHP8h5j/A+ApwMGYNFZs5pX8Q21vrz8NtFliVGc1mwdkODxP0vGOgKWI9DD7o0APhEuAig79CcHy2rUFPOw0Tjbh7ud6JzPd4UsBMW/0SYMmrtel9yXVf3w9U1i2YuE8217X6Jw0b97xS2RMKrhRMR8u56zuKXcQooVPlEmDOyzCML+/aCx1YkxoLEISMytFdwS0Bjq8GO6jYdURJZ3zCQQBuuVW7ars3UnBLw+PA1NE+V/CeiOX8eCDMxXK/L3YtxaDglgAnfhdQmagad0qxa4kKxz+K88sReYtgCVJwS0BH67nPAI/g/Huxa4mCyTOaDjD4gJvdXuxaikXBLRXGdcDMytr0u4pdSqnrids3gKwFsVH75j4Ft0Rkpm68GVgRhHY1qZT+f9mJqpnN0xz+y/CLMkvmZopdT7HoA1IqUqkwCPkC5tOqHh1/ya43GH0q6xZMtNBvBx5vrzhkYbHrKSbNPFBCXn76/pVjDvtghxnfHHPYB/6++en7Hy92TSVjzvVl+2S72oDXufPBrsVz1he7pGJScEvM5qfv/80+h33wNZh9bZ+3fmD95j/fP6rfAwtQdepl1fts6l7icELMghmZ1vonil1TsSm4JWjzGSfcO+bFskqwb455y4cmTzzs3cs7n16+Z/MO7yWqaxdMMbP7gDcGbqe2t9b/qtg1lQK9kb6EVdU2n4n7tw3WuFOfbatv2Tr7/96v6tTLqi1e9nXcPwf+lOfKZmbvmfvXYtdVKhTcEldVk36DGc3A6cDf3LkNC5dkK17+ff/H8aJuQk3zpBi8x+Bjbp4EtmD29cz+E67ZflZJUXAjYmLN/ONylvuUYXVA37Qy7a+2TcRUAGN7/30F2G093Vt+sGHZhWuKWVSpUnCjZs71ZZWrO44O4O0e+r6w64nbosDwTR4EL5p1/zaz5ILnil2PiIiIiIiIiIiIiIiIiIiIiIiIlJr/D04XNlEWPqivAAAAAElFTkSuQmCC" width="238" height="364" class="img_ev3q"></p>
<p>There are various ways you can use <code>reftree</code>:</p>
<ul>
<li>improving the documentation of your projects;</li>
<li>live-coding demos;</li>
<li>exploring how things work;</li>
<li>anywhere you need diagrams of your Scala data structures.</li>
</ul>
<p>(<em>Incidentally, this talk is an example of all of the above.</em>)</p>
<p>My previous <code>reftree</code>-powered <a href="/reftree/docs/talks/Immutability">talk</a> focused on
immutable data and various ways it can be manipulated (I do recommend it).</p>
<p>Today I would like to take you on a journey deep inside <code>reftree</code> itself,
so that we can see how some of these techniques and concepts can be applied...
to produce visualizations of themselves — using one of my favorite <code>reftree</code>
features: animations.</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Animation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">startWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Queue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">repeat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">iterate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">q </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"> q </span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">q</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">max </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">iterate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tail</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Diagram</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toStringCaption</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">withAnchor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;queue&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;queue&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="queue" src="/reftree/assets/images/queue-668a708310e8e78475fbc9b757c69eb3.gif" width="540" height="922" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="inside-reftree">Inside <code>reftree</code><a class="hash-link" aria-label="Direct link to inside-reftree" title="Direct link to inside-reftree" href="/reftree/docs/talks/Visualize#inside-reftree">​</a></h2>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// extra declarations for this section</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">reftree</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">contrib</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">SimplifiedInstances</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">option</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> seq</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> list</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>First, we need to grasp the basics of <code>reftree</code>.</p>
<p>To visualize a value of some type <code>A</code>, <code>reftree</code> converts it into a data structure
called <code>RefTree</code> (surprise!), using a typeclass <code>ToRefTree[A]</code>.</p>
<p>For case classes this is done automagically, using
<a href="https://github.com/milessabin/shapeless/wiki/Feature-overview:-shapeless-2.0.0#generic-representation-of-sealed-families-of-case-classes" target="_blank" rel="noopener noreferrer"><em>shapeless</em></a>.
(<em>If you are curious about the magic, take a look at <a href="https://github.com/stanch/reftree/blob/master/core/shared/src/main/scala/reftree/core/GenericInstances.scala" target="_blank" rel="noopener noreferrer">this file</a>.</em>)
Given our friend <code>bob</code>, <em>shapeless</em> would provide a generic representation,
which includes the field names (at the type level!) and the values (as a heterogeneous list):</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Shortcuts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">generic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res2: shapeless.::[String with shapeless.labelled.KeyTag[Symbol with shapeless.tag.Tagged[&quot;firstName&quot;], String], shapeless.::[Int with shapeless.labelled.KeyTag[Symbol with shapeless.tag.Tagged[&quot;age&quot;], Int], shapeless.HNil]] = &quot;Bob&quot; :: 42 :: HNil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Shortcuts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">generic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;generic&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="generic" src="/reftree/assets/images/generic-2c235d68ea9ba3134644dfbbfcfc8d0e.png" width="417" height="460" class="img_ev3q"></p>
<p>This information is enough to auto-generate a <code>RefTree</code>.
Now, what does it look like? The best way to find out is to visualize a <code>RefTree</code>
of a <code>RefTree</code>!</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Shortcuts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">refTree</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;reftree&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="reftree" src="/reftree/assets/images/reftree-89a18ab93544f7f9592b99af3dca2ca0.png" width="1520" height="836" class="img_ev3q"></p>
<p>As you can see, it contains values (<code>Val</code>) and references (<code>Ref</code>).</p>
<p>How do we get from <code>RefTree</code> to an image though?
This is where <a href="http://www.graphviz.org/" target="_blank" rel="noopener noreferrer">GraphViz</a> comes in.
From a <code>RefTree</code> we can obtain a graph definition that can be rendered by GraphViz:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Shortcuts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">graph</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res5: String = &quot;&quot;&quot;digraph &quot;Diagram&quot; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   graph [ ranksep=0.8 bgcolor=&quot;#ffffff00&quot; ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   node [ shape=&quot;plaintext&quot; fontname=&quot;Source Code Pro&quot; fontcolor=&quot;#000000ff&quot; ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   edge [ arrowsize=0.7 color=&quot;#000000ff&quot; ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   &quot;-repl.MdocSession$MdocApp$Person342877447&quot; [ id=&quot;-repl.MdocSession$MdocApp$Person342877447&quot; label=&lt;&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;6&quot; cellborder=&quot;0&quot; columns=&quot;*&quot; bgcolor=&quot;#ffffff00&quot; style=&quot;rounded&quot;&gt;&lt;tr&gt;&lt;td port=&quot;n&quot; rowspan=&quot;2&quot;&gt;Person&lt;/td&gt;&lt;td bgcolor=&quot;#ffffff00&quot;&gt;&lt;i&gt;name&lt;/i&gt;&lt;/td&gt;&lt;td bgcolor=&quot;#ffffff00&quot;&gt;&lt;i&gt;age&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;&lt;hr/&gt;&lt;tr&gt;&lt;td port=&quot;0&quot; bgcolor=&quot;#ffffff00&quot;&gt;&amp;middot;&lt;/td&gt;&lt;td bgcolor=&quot;#ffffff00&quot;&gt;42&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&gt; ] [ color=&quot;#104e8bff&quot; fontcolor=&quot;#104e8bff&quot; ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   &quot;-java.lang.String1172745511&quot; [ id=&quot;-java.lang.String1172745511&quot; label=&lt;&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;6&quot; cellborder=&quot;0&quot; columns=&quot;*&quot; bgcolor=&quot;#ffffff00&quot; style=&quot;rounded&quot;&gt;&lt;tr&gt;&lt;td port=&quot;n&quot; rowspan=&quot;2&quot;&gt;&amp;quot;Bob&amp;quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&gt; ] [ color=&quot;#104e8bff&quot; fontcolor=&quot;#104e8bff&quot; ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   &quot;-repl.MdocSession$MdocApp$Person342877447&quot;:&quot;0&quot;:&quot;s&quot; -&gt; &quot;-java.lang.String1172745511&quot;:&quot;n&quot;:&quot;n&quot; [ id=&quot;-repl.MdocSession$MdocApp$Person342877447-0-java.lang.String1172745511&quot; ] [ color=&quot;#104e8bff&quot; ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// }&quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Going even further, we can ask GraphViz for an <a href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics" target="_blank" rel="noopener noreferrer">SVG</a> output:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Shortcuts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res6: xml.Node = &lt;svg width=&quot;171pt&quot; height=&quot;168pt&quot; viewBox=&quot;0.00 0.00 171.00 168.00&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;&lt;g id=&quot;graph0&quot; class=&quot;graph&quot;&gt;&lt;title&gt;Diagram&lt;/title&gt;&lt;polygon fill=&quot;transparent&quot; stroke=&quot;transparent&quot; points=&quot;-4,4 -4,-164 167,-164 167,4 -4,4&quot;/&gt;&lt;!-- &amp;#45;repl.MdocSession$MdocApp$Person342877447 --&gt;&lt;g id=&quot;-repl.MdocSession$MdocApp$Person342877447&quot; class=&quot;node&quot;&gt;&lt;title&gt;-repl.MdocSession$MdocApp$Person342877447&lt;/title&gt;&lt;path fill=&quot;transparent&quot; stroke=&quot;transparent&quot; d=&quot;M20,-100C20,-100 143,-100 143,-100 149,-100 155,-106 155,-112 155,-112 155,-144 155,-144 155,-150 149,-156 143,-156 143,-156 20,-156 20,-156 14,-156 8,-150 8,-144 8,-144 8,-112 8,-112 8,-106 14,-100 20,-100&quot;/&gt;&lt;text text-anchor=&quot;start&quot; x=&quot;15.5&quot; y=&quot;-124.3&quot; font-family=&quot;Source Code Pro&quot; font-size=&quot;14.00&quot; fill=&quot;#104e8b&quot;&gt;Person&lt;/text&gt;&lt;polygon fill=&quot;transparent&quot; stroke=&quot;transparent&quot; points=&quot;71.5,-128 71.5,-155 117.5,-155 117.5,-128 71.5,-128&quot;/&gt;&lt;text text-anchor=&quot;start&quot; x=&quot;77.5&quot; y=&quot;-138.8&quot; font-family=&quot;Source Code Pro&quot; font-style=&quot;italic&quot; font-size=&quot;14.00&quot; fill=&quot;#104e8b&quot;&gt;name&lt;/text&gt;&lt;polygon fill=&quot;transparent&quot; stroke=&quot;transparent&quot; points=&quot;117.5,-128 117.5,-155 154.5,-155 154.5,-128 117.5,-128&quot;/&gt;&lt;text text-anchor=&quot;start&quot; x=&quot;123.5&quot; y=&quot;-138.8&quot; font-family=&quot;Source Code Pro&quot; font-style=&quot;italic&quot; font-size=&quot;14.00&quot; fill=&quot;#104e8b&quot;&gt;age&lt;/text&gt;&lt;polygon fill=&quot;transparent&quot; stroke=&quot;transparent&quot; points=&quot;71.5,-101 71.5,-128 117.5,-128 117.5,-101 71.5,-101&quot;/&gt;&lt;text text-anchor=&quot;start&quot; x=&quot;90&quot; y=&quot;-110.8&quot; font-family=&quot;Source Code Pro&quot; font-size=&quot;14.00&quot; fill=&quot;#104e8b&quot;&gt;·&lt;/text&gt;&lt;polygon fill=&quot;transparent&quot; stroke=&quot;transparent&quot; points=&quot;117.5,-101 117.5,-128 154.5,-128 154.5,-101 117.5,-101&quot;/&gt;&lt;text text-anchor=&quot;start&quot; x=&quot;127.5&quot; y=&quot;-110.8&quot; font-family=&quot;Source Code Pro&quot; font-size=&quot;14.00&quot; fill=&quot;#104e8b&quot;&gt;42&lt;/text&gt;&lt;polygon fill=&quot;#104e8b&quot; stroke=&quot;#104e8b&quot; points=&quot;71.5,-101 71.5,-156 71.5,-156 71.5,-101 71.5,-101&quot;/&gt;&lt;polygon fill=&quot;#104e8b&quot; stroke=&quot;#104e8b&quot; points=&quot;117.5,-128 117.5,-156 117.5,-156 117.5,-128 117.5,-128&quot;/&gt;&lt;polygon fill=&quot;#104e8b&quot; stroke=&quot;#104e8b&quot; points=&quot;71.5,-128 71.5,-128 117.5,-128 117.5,-128 71.5,-128&quot;/&gt;&lt;polygon fill=&quot;#104e8b&quot; stroke=&quot;#104e8b&quot; points=&quot;117.5,-128 117.5,-128 155.5,-128 155.5,-128 117.5,-128&quot;/&gt;&lt;polygon fill=&quot;#104e8b&quot; stroke=&quot;#104e8b&quot; points=&quot;117.5,-100 117.5,-128 117.5,-128 117.5,-100 117.5,-100&quot;/&gt;&lt;path fill=&quot;none&quot; stroke=&quot;#104e8b&quot; d=&quot;M20,-100C20,-100 143,-100 143,-100 149,-100 155,-106 155,-112 155,-112 155,-144 155,-144 155,-150 149,-156 143,-156 143,-156 20,-156 20,-156 14,-156 8,-150 8,-144 8,-144 8,-112 8,-112 8,-106 14,-100 20,-100&quot;/&gt;&lt;/g&gt;&lt;!-- &amp;#45;java.lang.String1172745511 --&gt;&lt;g id=&quot;-java.lang.String1172745511&quot; class=&quot;node&quot;&gt;&lt;title&gt;-java.lang.String1172745511&lt;/title&gt;&lt;path fill=&quot;transparent&quot; stroke=&quot;transparent&quot; d=&quot;M76.5,-4C76.5,-4 112.5,-4 112.5,-4 117.5,-4 122.5,-9 122.5,-14 122.5,-14 122.5,-24 122.5,-24 122.5,-29 117.5,-34 112.5,-34 112.5,-34 76.5,-34 76.5,-34 71.5,-34 66.5,-29 66.5,-24 66.5,-24 66.5,-14 66.5,-14 66.5,-9 71.5,-4 76.5,-4&quot;/&gt;&lt;text text-anchor=&quot;start&quot; x=&quot;73.5&quot; y=&quot;-15.3&quot; font-family=&quot;Source Code Pro&quot; font-size=&quot;14.00&quot; fill=&quot;#104e8b&quot;&gt;&amp;quot;Bob&amp;quot;&lt;/text&gt;&lt;path fill=&quot;none&quot; stroke=&quot;#104e8b&quot; d=&quot;M76.5,-4C76.5,-4 112.5,-4 112.5,-4 117.5,-4 122.5,-9 122.5,-14 122.5,-14 122.5,-24 122.5,-24 122.5,-29 117.5,-34 112.5,-34 112.5,-34 76.5,-34 76.5,-34 71.5,-34 66.5,-29 66.5,-24 66.5,-24 66.5,-14 66.5,-14 66.5,-9 71.5,-4 76.5,-4&quot;/&gt;&lt;/g&gt;&lt;!-- &amp;#45;repl.MdocSession$MdocApp$Person342877447&amp;#45;&amp;gt;&amp;#45;java.lang.String1172745511 --&gt;&lt;g id=&quot;-repl.MdocSession$MdocApp$Person342877447-0-java.lang.String1172745511&quot; class=&quot;edge&quot;&gt;&lt;title&gt;-repl.MdocSession$MdocApp$Person342877447:s-&amp;gt;-java.lang.String1172745511:n&lt;/title&gt;&lt;path fill=&quot;none&quot; stroke=&quot;#104e8b&quot; d=&quot;M94.5,-100C94.5,-73.19 94.5,-64.76 94.5,-41.1&quot;/&gt;&lt;polygon fill=&quot;#104e8b&quot; stroke=&quot;#104e8b&quot; points=&quot;96.95,-41 94.5,-34 92.05,-41 96.95,-41&quot;/&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>At this point you might be guessing how we can use this as a basis for our animation approach.
Every state of a data structure will be a separate frame in the SVG format.
However, an animation consisting of these frames alone would be too jumpy.
We need to add intermediate frames to smoothly “morph” one frame into another.
With SVG being a vector format, this sounds simple.
We just have to individually morph different aspects of the image:</p>
<ul>
<li>graph node positions;</li>
<li>graph edges and their shapes;</li>
<li>colors;</li>
<li>stroke thickness;</li>
<li>transparency.</li>
</ul>
<p>Ouch! A sane functional approach would definitely help here :)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="functional-animation">Functional animation<a class="hash-link" aria-label="Direct link to Functional animation" title="Direct link to Functional animation" href="/reftree/docs/talks/Visualize#functional-animation">​</a></h2>
<p>Let’s start by introducing an abstraction for morphing, or, in other words,
interpolating things of type <code>A</code>:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">trait</span><span class="token plain"> Interpolation</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">A</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">left</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> right</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> time</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Double</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">left</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> right</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inclusive</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Boolean</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Seq</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">A</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(<em>If you are curious, <a href="https://github.com/stanch/reftree/blob/master/core/shared/src/main/scala/reftree/geometry/Interpolation.scala" target="_blank" rel="noopener noreferrer">here is the actual implementation</a>.</em>)</p>
<p>Once we have an instance of <code>Interpolation[xml.Node]</code>, we can generate
as many intermediate frames as we want! But how do we construct this instance?</p>
<p>Consider a lowly floating point number (it can represent an <em>x</em> coordinate of some element in our SVG, for example).
There is an obvious way to implement <code>Interpolation[Double]</code>, which <code>reftree</code> already defines as <code>Interpolation.double</code>:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> numbers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Interpolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">double</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// numbers: List[Double] = List(0.0, 2.5, 5.0, 7.5, 10.0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">numbers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;numbers&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="numbers" src="data:image/png;base64,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" width="376" height="193" class="img_ev3q"></p>
<p>Now if you think about a point in 2D space, it’s just two numbers joined together:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> point </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Point</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// point: Point = Point(x = 0.0, y = 10.0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">point</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;point&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="point" src="data:image/png;base64,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" width="226" height="231" class="img_ev3q"></p>
<p>Can we use the number interpolation to interpolate these two numbers?
To answer this question, let’s introduce more abstraction
(in a great tradition of functional programming).</p>
<p>A lens <code>Lens[A, B]</code> is something that can “focus” on a piece of data of type <code>B</code>
inside a data structure of type <code>A</code> and provide read-write access to it.
We will use the excellent <a href="https://github.com/julien-truffaut/Monocle" target="_blank" rel="noopener noreferrer"><em>Monocle</em> library</a>
to create lenses and other optics along the way:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">monocle</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token namespace" style="opacity:0.7">macros</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">GenLens</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GenLens</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Point</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// x: monocle.package.Lens[Point, Double] = repl.MdocSession$MdocApp$$anon$1@1b1555ca</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GenLens</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Point</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// y: monocle.package.Lens[Point, Double] = repl.MdocSession$MdocApp$$anon$2@1ba92b68</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OpticFocus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> point</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toNamespace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OpticFocus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> point</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toNamespace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;y&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;x+y&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="x+y" src="/reftree/assets/images/x+y-c7fbf58ef886ad0cf3d32f18259c15be.png" width="580" height="231" class="img_ev3q"></p>
<p>Lenses provide several methods to manipulate data:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">point</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res10: Double = 0.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">point</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res11: Point = Point(x = 0.0, y = 20.0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">modify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_ </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">point</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res12: Point = Point(x = 0.0, y = 30.0)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If we can read and write each coordinate field, we can interpolate them separately
and update the point field by field.
We do this by piping <code>Interpolation.double</code> through <code>x</code> and <code>y</code> lenses
and combining the resulting interpolations:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> pointInterpolation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interpolateWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Interpolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">double</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  y</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interpolateWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Interpolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">double</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// pointInterpolation: Interpolation[Point] = reftree.geometry.Interpolation$$anonfun$apply$4@2bccedad</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> points </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pointInterpolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Point</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Point</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// points: List[Point] = List(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   Point(x = 0.0, y = 0.0),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   Point(x = 2.5, y = 5.0),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   Point(x = 5.0, y = 10.0),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   Point(x = 7.5, y = 15.0),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   Point(x = 10.0, y = 20.0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// )</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">points</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;points&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="points" src="/reftree/assets/images/points-5c9c6c00db5175c0d948a09163a40637.png" width="1176" height="363" class="img_ev3q"></p>
<p>Of course, <code>reftree</code> already defines this as <code>Point.interpolation</code>.</p>
<p>Using the same approach, we can build a polyline interpolator
(assuming the polylines being interpolated consist of equal number of points):</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">polyline1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res14: Polyline = Polyline(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   points = List(Point(x = 0.0, y = 10.0), Point(x = 10.0, y = 20.0))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// )</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">polyline2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res15: Polyline = Polyline(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   points = List(Point(x = 20.0, y = 30.0), Point(x = 40.0, y = 50.0))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// )</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> polylineInterpolation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GenLens</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Polyline</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">points</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interpolateEachWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Point</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interpolation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// polylineInterpolation: Interpolation[Polyline] = reftree.geometry.Interpolation$$anonfun$apply$4@8ad0725</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> polylines </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> polylineInterpolation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">polyline1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">polyline2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// polylines: List[Polyline] = List(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   Polyline(points = List(Point(x = 0.0, y = 10.0), Point(x = 10.0, y = 20.0))),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   Polyline(points = List(Point(x = 10.0, y = 20.0), Point(x = 25.0, y = 35.0))),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//   Polyline(points = List(Point(x = 20.0, y = 30.0), Point(x = 40.0, y = 50.0)))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// )</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">polylines</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;polylines&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="polylines" src="/reftree/assets/images/polylines-00e6358bcbdecbf9807c0bc2ade2d3f9.png" width="1491" height="664" class="img_ev3q"></p>
<p>We are finally ready to implement our first substantial interpolator: one that morphs graph edges.
<em>The following approach is inspired by Mike Bostock’s <a href="https://bl.ocks.org/mbostock/3916621" target="_blank" rel="noopener noreferrer">path tween</a>,
however <code>reftree</code> puts more emphasis on types and even includes its own
<a href="https://github.com/stanch/reftree/blob/master/core/shared/src/main/scala/reftree/geometry/Path.scala" target="_blank" rel="noopener noreferrer">SVG path parser and simplification algorithm</a>.</em></p>
<p>The resulting animation should look like this:</p>
<p><img decoding="async" loading="lazy" alt="edges-100" src="/reftree/assets/images/edges-100-9cbc68a0debf543244c33b7d26b22709.gif" width="361" height="194" class="img_ev3q"></p>
<p>An edge is drawn with an <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths" target="_blank" rel="noopener noreferrer">SVG path</a>,
which consists of several commands, e.g. “move to”, “line to”, “bezier curve to”.
Here is a minimized SVG snippet for an actual edge:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edge1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res17: xml.Node = &lt;svg viewBox=&quot;50 -200 130 70&quot; height=&quot;70pt&quot; width=&quot;130pt&quot; shape-rendering=&quot;geometricPrecision&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;&lt;g class=&quot;edge&quot;&gt;&lt;path d=&quot;M84.5,-195C84.5,-165.869 62.5907,-160.925 58.9962,-135.762&quot; stroke=&quot;#104e8b&quot; fill=&quot;none&quot;/&gt;&lt;/g&gt;&lt;/svg&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edge1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;edge&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="edge" src="/reftree/assets/images/edge-0a8b76cae995e0a8c485063cb500de8a.png" width="1365" height="703" class="img_ev3q"></p>
<p>As you can see, the commands themselves are given in the <code>d</code> attribute inside the <code>path</code> element
in a rather obscure format. Luckily, we have lenses and other optics at our disposal
to plumb through this mess.</p>
<p>First, let’s get to the <code>path</code> element. <code>reftree</code> implements a few things that will help us:</p>
<ul>
<li><code>XmlSvgApi</code>, an implementation of several useful SVG operations for <em>scala-xml</em>.
In particular, if offers a CSS selector-like method for matching elements of certain type and/or class.</li>
<li>An optic that focuses on an element deep inside XML or any other recursive data structure: <code>Optics.collectFirst</code>.
It is actually an <code>Optional</code>, not a <code>Lens</code>, since the element might be missing.</li>
</ul>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> edgePathElement </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Optics</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">collectFirst</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">XmlSvgApi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;path&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// edgePathElement: monocle.package.Optional[xml.Node, xml.Node] = monocle.Optional$$anon$6@3927a8ff</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OpticFocus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">edgePathElement</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edge1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;edgePathElement&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="edgePathElement" src="/reftree/assets/images/edgePathElement-8070f24cd6faf257dbf2357bbc26ab75.png" width="1408" height="703" class="img_ev3q"></p>
<p>Next, we need to “descend” to the <code>d</code> attribute. Here is where optics really shine:
we can compose <code>Optional[A, B]</code> with <code>Optional[B, C]</code> to get an <code>Optional[A, C]</code>:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> d </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> XmlSvgApi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">attr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;d&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// d: monocle.package.Optional[xml.Node, String] = monocle.POptional$$anon$1@6b0726d8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> edgePathString </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> edgePathElement composeOptional d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// edgePathString: monocle.POptional[xml.Node, xml.Node, String, String] = monocle.POptional$$anon$1@276a0f90</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OpticFocus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">edgePathString</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edge1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;edgePathString&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="edgePathString" src="/reftree/assets/images/edgePathString-e95d3068168658ba325a9e873dbf2612.png" width="1403" height="703" class="img_ev3q"></p>
<p>Next, we will use an isomorphism, another kind of optic, to view
the string as a nice case class:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stringIso</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res21: monocle.package.Iso[String, Path] = monocle.PIso$$anon$9@471ea077</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> edgePath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> edgePathString composeIso Path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stringIso</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// edgePath: monocle.POptional[xml.Node, xml.Node, Path, Path] = monocle.POptional$$anon$1@43fa983b</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">edgePath</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getOption</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edge1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;edgePath&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="edgePath" src="/reftree/assets/images/edgePath-e11472fa0a55e29fd9de9876ff597ceb.png" width="1435" height="701" class="img_ev3q"></p>
<p>And finally, another isomorphism takes us from a <code>Path</code> to its sampled representation
as a <code>Polyline</code>. (<em>Purists will say that this is not really an isomorphism because
it’s not reversible, but with a lot of points you can get pretty close ;)</em>)</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">polylineIso</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">points </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res23: monocle.package.Iso[Path, Polyline] = monocle.PIso$$anon$9@1199577a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> edgePolyline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">points</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> edgePath composeIso Path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">polylineIso</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">points</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">edgePolyline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getOption</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edge1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;edgePolyline&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="edgePolyline" src="/reftree/assets/images/edgePolyline-7c4044c84e38ce242eefda017e1e188c.png" width="1727" height="532" class="img_ev3q"></p>
<p>Let’s interpolate!</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> edgeInterpolation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">points</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> edgePolyline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">points</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interpolateWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Polyline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interpolation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> edges</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">points</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> frames</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edge1 </span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  edgeInterpolation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">points</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edge1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edge2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> frames</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inclusive </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edge2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AnimatedGifRenderer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">renderFrames</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  edges</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Frame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Paths</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ImagePath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;visualize&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;edges-4.gif&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RenderingOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">density </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AnimationOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">framesPerSecond </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AnimatedGifRenderer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">renderFrames</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  edges</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Frame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Paths</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ImagePath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;visualize&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;edges-100.gif&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RenderingOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">density </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AnimationOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">framesPerSecond </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With 4 points and 4 frames:</p>
<p><img decoding="async" loading="lazy" alt="edges-4" src="/reftree/assets/images/edges-4-788922eab8ebbf8f1d0ffaa9a071132b.gif" width="361" height="194" class="img_ev3q"></p>
<p>With 100 points and 32 frames:</p>
<p><img decoding="async" loading="lazy" alt="edges-100" src="/reftree/assets/images/edges-100-9cbc68a0debf543244c33b7d26b22709.gif" width="361" height="194" class="img_ev3q"></p>
<p><em>Interpolating the entire image is left as an exercise for the reader,
although the impatient will find the complete implementation
<a href="https://github.com/stanch/reftree/blob/master/core/shared/src/main/scala/reftree/svg/animation/GraphInterpolation.scala" target="_blank" rel="noopener noreferrer">here</a>.</em></p>
<p>Notice that we never touched XML directly.
In fact, equipped with the same set of optics for another format or representation,
we would be able to operate on it without changing the code too much.
Case in point: <code>reftree</code> supports both
<a href="https://github.com/stanch/reftree/blob/master/core/jvm/src/main/scala/reftree/svg/XmlSvgApi.scala" target="_blank" rel="noopener noreferrer"><em>scala-xml</em></a> and
<a href="https://github.com/stanch/reftree/blob/master/core/js/src/main/scala/reftree/svg/DomSvgApi.scala" target="_blank" rel="noopener noreferrer"><em>scala-js-dom</em></a> (for Scala.js),
with only 50 lines of implementation-specific code for each backend.
This goes to show the flexibility and usefulness of optics.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="zipping-it-up">Zipping it up<a class="hash-link" aria-label="Direct link to Zipping it up" title="Direct link to Zipping it up" href="/reftree/docs/talks/Visualize#zipping-it-up">​</a></h2>
<p>In the previous section we saw <code>Optics.collectFirst</code> — an optic that is able to perform
modifications deep inside SVG. How do we go about implementing something like this,
or, more generally, how do we edit recursive data structures such as XML?</p>
<p>This solution is called a “Zipper”, and was introduced by Gérard Huet in 1997.
It consists of a “cursor” pointing to a location anywhere in a tree — “current focus”.
The cursor can be moved freely with operations like <code>moveDownLeft</code>, <code>moveRight</code>, <code>moveUp</code>, etc.
Current focus can be updated, deleted, or new nodes can be inserted to its left or right.
Zippers are immutable, and every operation returns a new Zipper.
All the changes made to the tree can be committed, yielding a new modified version of the original tree.</p>
<p>My <a href="https://github.com/stanch/zipper#zipper--an-implementation-of-huets-zipper" target="_blank" rel="noopener noreferrer">zipper library</a>
provides a few useful movements and operations. Just like optics, it’s rather generic and flexible.
The zipper can operate on any type, as long as an instance of the <code>Unzip</code> typeclass is available,
which can be automatically derived in many cases.
(<em>Note that the derivation of <code>Unzip</code> for SVG can be found
<a href="https://github.com/stanch/reftree/blob/master/core/shared/src/main/scala/reftree/svg/api/BaseSvgApi.scala" target="_blank" rel="noopener noreferrer">here</a>.</em>)</p>
<p>Consider a simple XML tree:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">simpleXml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// res27: xml.Node = &lt;tree value=&quot;1&quot;&gt;&lt;leaf value=&quot;2&quot;/&gt;&lt;leaf value=&quot;3&quot;/&gt;&lt;leaf value=&quot;4&quot;/&gt;&lt;tree value=&quot;5&quot;&gt;&lt;leaf value=&quot;6&quot;/&gt;&lt;leaf value=&quot;7&quot;/&gt;&lt;/tree&gt;&lt;/tree&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">simpleXml</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;simpleXml&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="simpleXml" src="/reftree/assets/images/simpleXml-33e8a5f26cea7dd70c3808d86690488b.png" width="1277" height="703" class="img_ev3q"></p>
<p>When we wrap a Zipper around this tree, it does not look very interesting yet:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">zipper</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token plain">Zipper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> zipper1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Zipper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">simpleXml</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// zipper1: Zipper[xml.Node] = Zipper(List(),&lt;tree value=&quot;1&quot;&gt;&lt;leaf value=&quot;2&quot;/&gt;&lt;leaf value=&quot;3&quot;/&gt;&lt;leaf value=&quot;4&quot;/&gt;&lt;tree value=&quot;5&quot;&gt;&lt;leaf value=&quot;6&quot;/&gt;&lt;leaf value=&quot;7&quot;/&gt;&lt;/tree&gt;&lt;/tree&gt;,List(),None)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">simpleXml</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">zipper1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zipper1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="zipper1" src="/reftree/assets/images/zipper1-5f0e8ccac0548193671b75d4f96125e4.png" width="1321" height="872" class="img_ev3q"></p>
<p>We can see that it just points to the original tree.
In this case the focus is the root of the tree, which has no siblings,
and the parent zipper does not exist, since we are at the top level.</p>
<p>To move down the tree, we “unzip” it, separating the child nodes into
the focused node and its left and right siblings:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> zipper2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipper1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">moveDownLeft</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// zipper2: Zipper[xml.Node] = Zipper(List(),&lt;leaf value=&quot;2&quot;/&gt;,List(&lt;leaf value=&quot;3&quot;/&gt;, &lt;leaf value=&quot;4&quot;/&gt;, &lt;tree value=&quot;5&quot;&gt;&lt;leaf value=&quot;6&quot;/&gt;&lt;leaf value=&quot;7&quot;/&gt;&lt;/tree&gt;),Some(Zipper(List(),&lt;tree value=&quot;1&quot;&gt;&lt;leaf value=&quot;2&quot;/&gt;&lt;leaf value=&quot;3&quot;/&gt;&lt;leaf value=&quot;4&quot;/&gt;&lt;tree value=&quot;5&quot;&gt;&lt;leaf value=&quot;6&quot;/&gt;&lt;leaf value=&quot;7&quot;/&gt;&lt;/tree&gt;&lt;/tree&gt;,List(),None)))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">zipper1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">zipper2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zipper1+2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="zipper1+2" src="/reftree/assets/images/zipper1+2-bc931dc2a9a17d909a27f5ae5d1e095b.png" width="1366" height="1042" class="img_ev3q"></p>
<p>The new Zipper links to the old one,
which will allow us to return to the root of the tree when we are done applying changes.
This link however prevents us from seeing the picture clearly.
Let’s look at the second zipper alone:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">zipper2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zipper2b&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="zipper2b" src="/reftree/assets/images/zipper2b-b4d938aec16be4bc5d0601737ed9bd53.png" width="1178" height="872" class="img_ev3q"></p>
<p>Great! We have <code>2</code> in focus and <code>3, 4, 5</code> as right siblings. What happens if we move right a bit?</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> zipper3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipper2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">moveRightBy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// zipper3: Zipper[xml.Node] = Zipper(List(&lt;leaf value=&quot;3&quot;/&gt;, &lt;leaf value=&quot;2&quot;/&gt;),&lt;leaf value=&quot;4&quot;/&gt;,List(&lt;tree value=&quot;5&quot;&gt;&lt;leaf value=&quot;6&quot;/&gt;&lt;leaf value=&quot;7&quot;/&gt;&lt;/tree&gt;),Some(Zipper(List(),&lt;tree value=&quot;1&quot;&gt;&lt;leaf value=&quot;2&quot;/&gt;&lt;leaf value=&quot;3&quot;/&gt;&lt;leaf value=&quot;4&quot;/&gt;&lt;tree value=&quot;5&quot;&gt;&lt;leaf value=&quot;6&quot;/&gt;&lt;leaf value=&quot;7&quot;/&gt;&lt;/tree&gt;&lt;/tree&gt;,List(),None)))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">zipper3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zipper3&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="zipper3" src="/reftree/assets/images/zipper3-25b272311b7ec6ce2e1b0ce993d16055.png" width="1113" height="872" class="img_ev3q"></p>
<p>This is interesting! Notice that the left siblings are “inverted”.
This allows to move left and right in constant time, because the sibling
adjacent to the focus is always at the head of the list.</p>
<p>This also allows us to insert new siblings easily:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> zipper4 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipper3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">insertLeft</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">fruit</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// zipper4: Zipper[xml.Node] = Zipper(List(&lt;fruit/&gt;, &lt;leaf value=&quot;3&quot;/&gt;, &lt;leaf value=&quot;2&quot;/&gt;),&lt;leaf value=&quot;4&quot;/&gt;,List(&lt;tree value=&quot;5&quot;&gt;&lt;leaf value=&quot;6&quot;/&gt;&lt;leaf value=&quot;7&quot;/&gt;&lt;/tree&gt;),Some(Zipper(List(),&lt;tree value=&quot;1&quot;&gt;&lt;leaf value=&quot;2&quot;/&gt;&lt;leaf value=&quot;3&quot;/&gt;&lt;leaf value=&quot;4&quot;/&gt;&lt;tree value=&quot;5&quot;&gt;&lt;leaf value=&quot;6&quot;/&gt;&lt;leaf value=&quot;7&quot;/&gt;&lt;/tree&gt;&lt;/tree&gt;,List(),None)))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">zipper4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zipper4&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="zipper4" src="/reftree/assets/images/zipper4-cbb2cf5c5de815041892e7f3b09703f8.png" width="1235" height="872" class="img_ev3q"></p>
<p>And, as you might know, we can delete nodes and update the focus:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> zipper5 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipper4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">deleteAndMoveRight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">worm</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// zipper5: Zipper[xml.Node] = Zipper(List(&lt;fruit/&gt;, &lt;leaf value=&quot;3&quot;/&gt;, &lt;leaf value=&quot;2&quot;/&gt;),&lt;worm/&gt;,List(),Some(Zipper(List(),&lt;tree value=&quot;1&quot;&gt;&lt;leaf value=&quot;2&quot;/&gt;&lt;leaf value=&quot;3&quot;/&gt;&lt;leaf value=&quot;4&quot;/&gt;&lt;tree value=&quot;5&quot;&gt;&lt;leaf value=&quot;6&quot;/&gt;&lt;leaf value=&quot;7&quot;/&gt;&lt;/tree&gt;&lt;/tree&gt;,List(),None)))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">zipper5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zipper5&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="zipper5" src="/reftree/assets/images/zipper5-56ccb910b4b659418162c70c7d32c364.png" width="556" height="667" class="img_ev3q"></p>
<p>Finally, when we move up, the siblings at the current level are “zipped”
together and their parent node is updated:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> zipper6 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipper5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">moveUp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// zipper6: Zipper[xml.Node] = Zipper(List(),&lt;tree value=&quot;1&quot;&gt;&lt;leaf value=&quot;2&quot;/&gt;&lt;leaf value=&quot;3&quot;/&gt;&lt;fruit/&gt;&lt;worm/&gt;&lt;/tree&gt;,List(),None)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">zipper6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zipper6&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="zipper6" src="/reftree/assets/images/zipper6-5e74a23116f43ca88bf512b027cbdd9e.png" width="794" height="703" class="img_ev3q"></p>
<p>When we are done editing, the <code>.commit</code> shorthand can be used for going
all the way up (applying all the changes) and returning the focus.
Notice how all the unchanged nodes are shared between the old and the new XML.</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> notSoSimpleXml </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipper6</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">commit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// notSoSimpleXml: xml.Node = &lt;tree value=&quot;1&quot;&gt;&lt;leaf value=&quot;2&quot;/&gt;&lt;leaf value=&quot;3&quot;/&gt;&lt;fruit/&gt;&lt;worm/&gt;&lt;/tree&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">simpleXml</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> diagram</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">notSoSimpleXml</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;notSoSimpleXml&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="notSoSimpleXml" src="/reftree/assets/images/notSoSimpleXml-d176756e1aae1946e6d6fe906c9d9bbc.png" width="1560" height="703" class="img_ev3q"></p>
<p><em>Using an XML zipper, a determined reader can easily implement advanced lenses,
such as <code>Optics.collectFirst</code>, <code>Optics.collectLeftByKey</code>, etc, all found
<a href="https://github.com/stanch/reftree/blob/master/core/shared/src/main/scala/reftree/util/Optics.scala" target="_blank" rel="noopener noreferrer">here</a>.</em></p>
<p>To conclude, here is an animation of a zipper and the tree it operates on
(from my previous talk), produced (as we know now) not without zippers’ help:</p>
<p><img decoding="async" loading="lazy" alt="tree+zipper" src="/reftree/assets/images/tree+zipper-b1cf73da287eda26f64b667ce8dcf311.gif" width="1241" height="690" class="img_ev3q"></p>
<p>That’s all! Thank you for reading this far.
I hope you are leaving this page with some great <code>reftree</code> use-cases in mind :)</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/stanch/reftree/tree/main/docs/../site-gen/target/mdoc/talks/Visualize.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/reftree/docs/talks/Immutability"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Unzipping Immutability</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/reftree/docs/talks/Visualize#introducing-reftree">Introducing <code>reftree</code></a></li><li><a class="table-of-contents__link toc-highlight" href="/reftree/docs/talks/Visualize#inside-reftree">Inside <code>reftree</code></a></li><li><a class="table-of-contents__link toc-highlight" href="/reftree/docs/talks/Visualize#functional-animation">Functional animation</a></li><li><a class="table-of-contents__link toc-highlight" href="/reftree/docs/talks/Visualize#zipping-it-up">Zipping it up</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2014–2024 Nick Stanchenko</div></div></div></footer></div>
</body>
</html>